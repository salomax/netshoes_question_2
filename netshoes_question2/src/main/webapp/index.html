<!DOCTYPE html>
<html lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />

    <meta charset="iso-8859-1">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="salomao.marcos@gmail.com">
    
	<title>Netshoes Questão 1</title>
            
</head>	
<body ng-app="cepApp">
  
  	<div ng-controller="cepControl">
  		<div>
  			CEP 
  			<input  ng-model="cep" type="text" required /> 
  			<input type="button" value="Buscar CEP" ng-click="buscarEnderecoPorCEP(cep)" /> 
  			{{ mensagem }}</div>
  		<div>RUA : {{ endereco.rua }}</div>
  		<div>BAIRRO : {{ endereco.bairro }}</div>
  		<div>CIDADE : {{ endereco.cidade }}</div>
  		<div>ESTADO : {{ endereco.estado }}</div>
  	</div>
  	
  	<div>
  		Foram "mockados" os CEPs 22333999 e 22333000.
  	</div>
  	
	<!-- AngularJS -->
	<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.3.14/angular.min.js"></script>
	<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.3.14/angular-resource.min.js"></script>
	
	<script type="text/javascript">
	
	// module
	var app = angular.module('cepApp', ['ngResource']);
	
	// controller
	app.controller('cepControl', function($scope, $resource) {
		
		/**
		 * Método para buscar o endereço do CEP.
		 */
		$scope.buscarEnderecoPorCEP	= function(_cep) {
			 
			 $scope.endereco = null;

			 if (_cep == undefined || _cep == '') {
				 $scope.mensagem = 'CEP é obrigatório!';
				 return;
			 }
			 
			console.log('Buscando o endereço do CEP: ' + _cep);

			// Criando resource REST para o CEP
			var cepResource = $resource('services/cep/:cep', {
				cep: _cep,
				isArray: false
			});
		
			// Efetuando a requisição GET no servidor
			cepResource.get().$promise.then(
	    			function(endereco) {
	    				$scope.endereco = endereco;
	    			}, function(error) {
			    		console.log('Ocorreu um erro ao buscar o CEP: ' + error.data);
			    		$scope.mensagem = error.data;
			    	});
			
		};
	
	});
	
	</script>
    
</body>
</html>